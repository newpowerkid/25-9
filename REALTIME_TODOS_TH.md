# Todo List แบบ Real-time ด้วย Server-Sent Events (SSE)

## ภาพรวม
โปรเจคนี้เป็น Todo List ที่มีฟีเจอร์ real-time โดยใช้ Server-Sent Events (SSE) เพื่อให้การอัปเดต todo แสดงผลทันทีในทุกหน้าจอที่เปิดอยู่

## ฟีเจอร์หลัก
- **การอัปเดตแบบ Real-time**: เมื่อมีการเพิ่ม แก้ไข หรือลบ todo ในหน้าจอหนึ่ง จะแสดงผลทันทีในหน้าจออื่นๆ ที่เปิดอยู่
- **แสดงสถานะการเชื่อมต่อ**: มีไอคอนแสดงสถานะการเชื่อมต่อ SSE (เขียว = เชื่อมต่อ, แดง = ไม่เชื่อมต่อ)
- **การเชื่อมต่ออัตโนมัติ**: หากการเชื่อมต่อขาด จะพยายามเชื่อมต่อใหม่อัตโนมัติ
- **เฉพาะผู้ใช้**: ผู้ใช้แต่ละคนจะเห็นเฉพาะ todo ของตัวเองเท่านั้น

## วิธีการทำงาน

### Backend (API)
- **SSE Endpoint**: `/api/todos/sse` - สร้างการเชื่อมต่อแบบ persistent สำหรับการอัปเดตแบบ real-time
- **การส่งข้อมูล**: การดำเนินการ CRUD ทั้งหมด (สร้าง, แก้ไข, ลบ) จะส่งข้อมูลไปยัง client ที่เชื่อมต่ออยู่
- **การจัดการการเชื่อมต่อ**: ติดตามการเชื่อมต่อที่ใช้งานอยู่ของแต่ละผู้ใช้ และทำความสะอาดการเชื่อมต่อที่ขาดหายไป

### Frontend (React)
- **useTodosSSE Hook**: Custom hook ที่จัดการการเชื่อมต่อ SSE
- **การรวมกับ React Query**: อัปเดต cache อัตโนมัติเมื่อได้รับข้อความจาก SSE
- **การแสดงผล**: แสดงสถานะการเชื่อมต่อด้วยไอคอน WiFi

## การใช้งาน
1. **เข้าสู่ระบบ**: ผู้ใช้ต้องเข้าสู่ระบบเพื่อใช้ฟีเจอร์ real-time
2. **การเชื่อมต่ออัตโนมัติ**: การเชื่อมต่อ SSE จะเริ่มทำงานอัตโนมัติเมื่อเข้าสู่ระบบ
3. **การอัปเดตแบบ Real-time**: การเปลี่ยนแปลงใดๆ กับ todo จะแสดงผลทันทีในทุกหน้าจอที่เปิดอยู่
4. **สถานะการเชื่อมต่อ**: UI จะแสดงว่าการอัปเดตแบบ real-time ใช้งานได้หรือไม่

## การทดสอบ
เพื่อทดสอบฟีเจอร์ real-time:
1. เปิดแอปในหลายแท็บ/หน้าต่างของเบราว์เซอร์
2. เข้าสู่ระบบด้วยบัญชีเดียวกัน
3. เพิ่ม แก้ไข หรือลบ todo ในแท็บหนึ่ง
4. ดูการอัปเดตแบบ real-time ในแท็บอื่นๆ

## ข้อดี
- **ประสิทธิภาพ**: ใช้ SSE ซึ่งเบากว่า WebSocket
- **ความเสถียร**: มีการจัดการข้อผิดพลาดและการเชื่อมต่อใหม่อัตโนมัติ
- **ประสบการณ์ผู้ใช้**: การอัปเดตแบบ real-time ทำให้ผู้ใช้รู้สึกว่าแอปตอบสนองเร็ว
- **ความปลอดภัย**: แต่ละผู้ใช้เห็นเฉพาะข้อมูลของตัวเอง
